<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TPE - Product Showcase</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Manifest for PWA -->
    <link rel="manifest" href="manifest.json">
    <!-- iOS support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="POS Machines">
    <link rel="apple-touch-icon" href="images/pwa-192.png">
    <meta name="theme-color" content="#1976d2">
    <style>
        body { font-family: Arial, sans-serif; background: #fafafa; margin: 0; padding: 0; }
        header {
            position: fixed;
            top: 0; left: 0;
            width: 100%;
            background: #fff;
            z-index: 1000;
            border-bottom: 1px solid #eee;
        }
        .logo {
            height: 50px;
            margin: 10px;
        }
        .content { margin-top: 80px; }
        h1 { text-align: center; margin-top: 90px; }
        .product-listing {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 24px;
            margin: 30px auto;
            max-width: 900px;
        }
        .product-item {
            border: 1px solid #ddd;
            padding: 16px;
            border-radius: 8px;
            width: 220px;
            background: #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            text-align: center;
            transition: box-shadow 0.2s;
        }
        .product-item:hover {
            box-shadow: 0 4px 16px rgba(0,0,0,0.10);
        }
        .product-item img {
            max-width: 100%;
            height: 120px;
            object-fit: contain;
            border-radius: 4px;
            margin-bottom: 12px;
        }
        .product-item .name {
            font-size: 17px;
            font-weight: bold;
            margin: 10px 0 6px 0;
            color: #222;
        }
        .product-item .price {
            color: #e53935;
            font-size: 16px;
            margin: 4px 0 10px 0;
        }
        .product-item .link {
            display: inline-block;
            margin-top: 8px;
            padding: 6px 12px;
            background: #1976d2;
            color: #fff;
            border-radius: 4px;
            text-decoration: none;
            font-size: 14px;
            transition: background 0.18s;
        }
        .product-item .link:hover { background: #024284; }
        @media (max-width: 700px) {
            .product-listing { flex-direction: column; align-items: center; }
            .product-item { width: 90%; }
        }
        .delivery-label {
            margin: 8px 0;
            font-size: 13px;
            color: #1976d2;
            font-weight: 500;
        }
        .site-footer {
            background: #f5f5f5;
            color: #444;
            text-align: center;
            padding: 25px 10px 10px 10px;
            margin-top: 40px;
            font-size: 15px;
            border-top: 1px solid #e0e0e0;
        }
        .site-footer .footer-links {
            margin-bottom: 8px;
        }
        .site-footer a {
            color: #1976d2;
            text-decoration: none;
            margin: 0 8px;
        }
        .site-footer a:hover {
            text-decoration: underline;
        }
        .site-footer span {
            color: #aaa;
            margin: 0 4px;
        }
        /* PWA install banner style */
        #installBanner {
            display: none;
            position: fixed;
            bottom: 0; left: 0; right: 0;
            background: #1976d2;
            color: #fff;
            padding: 16px;
            text-align: center;
            z-index: 2000;
        }
        #installBanner button {
            background: #fff;
            color: #1976d2;
            border: none;
            border-radius: 4px;
            padding: 8px 16px;
            margin-left: 12px;
            cursor: pointer;
            font-size: 15px;
        }
    </style>
</head>
<body>
    <header>
        <a href="https://www.rechainglobal.com">
            <img src="images/rechain.jpg" alt="Your Company Logo" class="logo">
        </a>
    </header>
    <h1>Products List</h1>
    <div class="content">
        <div id="productContainer" class="product-listing"></div>
    </div>
    <div id="installBanner">
        Install this app for a faster experience!
        <button id="installBtn">Install</button>
    </div>
    <script>
        // Static product data (TWO ITEMS)
        const staticProductData = [
            // ... (Product data unchanged, paste from previous source)
            // [--- SNIP: The full staticProductData array from the original source ---]
            // For brevity, keep this unchanged.
            {
                "@type": "Product",
                "name": "PH-600-1 Portable Handheld POS Checkout Point of Sale Android Transaction Printer Payment Machine Mobile POS WiFi NFC Bluetooth",
                "image": "https://s.alicdn.com/@sc04/kf/H23cab4baf7a94f0b9fab3c8aae57a9dez.jpg_300x300.jpg",
                "offers": {
                    "type": "Offer",
                    "price": 141,
                    "priceCurrency": "USD",
                    "priceSpecification": {
                        "@type": "PriceSpecification",
                        "price": 141
                    }
                },
                "brand": "Easy Banker International Co., Ltd.",
                "url": "https://easybanker.en.alibaba.com/",
                "category": "Mobile POS"
            },
            // ... [Add all other product items here as in original file]
            // [--- SNIP: End ---]
        ];

        function renderProducts(products) {
            const container = document.getElementById('productContainer');
            container.innerHTML = ""; // Clear previous content

            products.forEach(product => {
                const productItem = document.createElement('div');
                productItem.className = 'product-item';

                const img = document.createElement('img');
                img.src = product.image;
                img.alt = product.name;

                const nameDiv = document.createElement('div');
                nameDiv.className = 'name';
                nameDiv.textContent = product.name;

                const priceDiv = document.createElement('div');
                priceDiv.className = 'price';
                priceDiv.textContent = product.offers && product.offers.price ? `$${product.offers.price}` : "N/A";
                const today = new Date();
                const minDeliveryDate = new Date(today);
                minDeliveryDate.setDate(today.getDate() + 3);
                const maxDeliveryDate = new Date(today);
                maxDeliveryDate.setDate(today.getDate() + 11);

                function formatDate(date) {
                    return date.toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: 'numeric' });
                }
                const deliveryDiv = document.createElement('div');
                deliveryDiv.className = 'delivery-label';
                deliveryDiv.textContent = `Delivery: ${formatDate(minDeliveryDate)} - ${formatDate(maxDeliveryDate)}`;

                const link = document.createElement('a');
                link.href = product.offers && product.offers.url ? product.offers.url : "#";
                link.textContent = "View Product";
                link.target = "_blank";
                link.className = "link";
                // Price parsing and fallback handling
                let parsedPrice = 25; // default fallback
                try {
                    let priceStr = product.offers.price ? product.offers.price.toString().replace(/[$â‚¦]/g, '').trim() : '';
                    parsedPrice = parseFloat(priceStr);
                    if (isNaN(parsedPrice)) {
                        parsedPrice = 25;
                        throw new Error('Price is not a valid number');
                    }
                } catch (error) {
                    console.error(`Failed to parse price for product ${product.name}:`, error);
                }

                // Currency handling (replace zparams with a default/fallback if not present)
                let origin = (typeof zparams !== 'undefined' && zparams.get) ? zparams.get('origin') : null;
                if (origin === "usd") {
                    link.href = `details_uri.html?origin=usd&name=${encodeURIComponent(product.name)}&price=${encodeURIComponent(((parsedPrice * 1) + (parsedPrice * 10 * 0.30)).toFixed(2))}&image_url=${encodeURIComponent(product.image)}`;
                    priceDiv.textContent = '$' + ((parsedPrice * 1) + (parsedPrice * 10 * 0.30)).toFixed(2);
                } else {
                    link.href = `details_uri.html?origin=usd&name=${encodeURIComponent(product.name)}&price=${encodeURIComponent(((parsedPrice * 1) + (parsedPrice * 10 * 0.30)).toFixed(2))}&image_url=${encodeURIComponent(product.image)}`;
                    priceDiv.textContent = '$' + ((parsedPrice * 1) + (parsedPrice * 10 * 0.30)).toFixed(2);
                }

                img.onerror = () => {
                    img.src = "images/fallback.jpg";
                    console.error(`Failed to load image: ${product.image}`);
                };

                productItem.appendChild(img);
                productItem.appendChild(nameDiv);
                productItem.appendChild(priceDiv);
                productItem.appendChild(deliveryDiv);
                productItem.appendChild(link);

                container.appendChild(productItem);
            });
        }

        renderProducts(staticProductData);

        // PWA: Service Worker registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('service-worker.js')
                .then(function(registration) {
                    // Registration successful
                    console.log('ServiceWorker registered with scope:', registration.scope);
                }, function(err) {
                    // Registration failed
                    console.log('ServiceWorker registration failed:', err);
                });
            });
        }

        // PWA: Install Banner
        let deferredPrompt;
        const installBanner = document.getElementById('installBanner');
        const installBtn = document.getElementById('installBtn');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBanner.style.display = 'block';
        });

        installBtn.addEventListener('click', async () => {
            installBanner.style.display = 'none';
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                deferredPrompt = null;
            }
        });

        window.addEventListener('appinstalled', () => {
            installBanner.style.display = 'none';
        });
    </script>
    <footer class="site-footer">
        <div class="footer-links">
            <a href="payment_policy.html" target="_blank">Terms of Service</a>
            <span>|</span>
            <a href="privacy_policy.html" target="_blank">Privacy Policy</a>
            <span>|</span>
            <a href="mailto:support@rechainglobal.com">Contact Us</a>
            <span>|</span>
            <span>2810 N Church St, Wilmington, DE 19802, United States</span>
        </div>
        <div class="footer-copyright">
            &copy; 2025 Rechain Global Trade&Business LLC. All rights reserved.
        </div>
    </footer>
</body>
</html>
