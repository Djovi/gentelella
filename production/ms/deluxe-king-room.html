<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Deluxe King Room</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
   <style>
  body {
    font-family: 'Segoe UI', Arial, sans-serif;
    background: linear-gradient(120deg, #f3f3f3 0%, #e9eafc 100%);
    margin: 0; padding: 0;
    min-height: 100vh;
  }
  .room-item {
    border: none;
    padding: 28px 24px 20px 24px;
    border-radius: 18px;
    width: 370px;
    background: #fff;
    box-shadow: 0 8px 32px rgba(32,60,120,0.08), 0 1.5px 6px rgba(25,118,210,0.08);
    margin: 40px auto 20px auto;
    position: relative;
    transition: box-shadow 0.2s;
  }
  .room-item:hover {
    box-shadow: 0 12px 40px rgba(32,60,120,0.18), 0 2.5px 12px rgba(25,118,210,0.13);
  }
  .carousel-container {
    position: relative;
    width: 100%;
    height: 220px;
    overflow: hidden;
    margin-bottom: 20px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(32,60,120,0.09);
  }
  .carousel-slide {
    display: none;
    width: 100%;
    height: 220px;
    object-fit: cover;
    border-radius: 12px;
    transition: opacity 0.3s;
  }
  .carousel-slide.active {
    display: block;
    opacity: 1;
  }
  .carousel-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(32,60,120,0.82);
    color: #fff;
    border: none;
    border-radius: 50%;
    width: 38px;
    height: 38px;
    cursor: pointer;
    font-size: 20px;
    transition: background 0.18s;
    z-index: 10;
  }
  .carousel-btn:hover { background: #1976d2; }
  .carousel-btn.prev { left: 14px; }
  .carousel-btn.next { right: 14px; }
  .name {
    font-size: 25px;
    font-weight: 700;
    margin: 14px 0 8px 0;
    color: #26245e;
    letter-spacing: 0.01em;
  }
  .price {
    color: #d84a4a;
    font-size: 20px;
    margin: 4px 0 16px 0;
    font-weight: 500;
  }
  .offers {
    font-size: 15px;
    color: #1976d2;
    margin-bottom: 18px;
    background: #f5f9ff;
    border-radius: 8px;
    padding: 8px 0;
  }
  .link {
    display: inline-block;
    margin-top: 10px;
    padding: 9px 26px;
    background: linear-gradient(90deg,#1976d2 0%,#26245e 100%);
    color: #fff;
    border-radius: 5px;
    text-decoration: none;
    font-size: 16px;
    font-weight: 600;
    box-shadow: 0 2px 12px rgba(25,118,210,0.08);
    transition: background 0.18s;
  }
  .link:hover { background: #024284; }
  #booking-form {
    max-width: 380px;
    margin: 0 auto 40px auto;
    padding: 24px 18px;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 2px 14px rgba(32,60,120,0.10);
    text-align: center;
  }
  #booking-form label {
    font-size: 16px;
    color: #222;
    margin-bottom: 7px;
    display: block;
    font-weight: 500;
  }
  #date-range {
    margin: 12px 0 18px 0;
    padding: 10px;
    border: 1px solid #bfc8e2;
    border-radius: 6px;
    font-size: 15px;
    width: 85%;
    box-sizing: border-box;
    transition: border 0.15s;
  }
  #date-range:focus {
    border: 1.8px solid #1976d2;
    outline: none;
    background: #f5f9ff;
  }
  #booking-form button[type="submit"] {
    padding: 10px 30px;
    background: linear-gradient(90deg,#1976d2 0%,#26245e 100%);
    color: #fff;
    border: none;
    border-radius: 6px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.18s;
    box-shadow: 0 1.5px 6px rgba(25,118,210,0.08);
  }
  #booking-form button[type="submit"]:hover {
    background: #024284;
  }
</style>
</head>
<body>
    <div class="room-item">
        <div class="carousel-container" id="carousel">
            <img class="carousel-slide active" src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=600&q=80" alt="Room image">
            <img class="carousel-slide" src="https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=600&q=80" alt="Room image">
            <button class="carousel-btn prev">&#8249;</button>
            <button class="carousel-btn next">&#8250;</button>
        </div>
        <div class="name">Deluxe King Room</div>
        <div class="price">$120 / night</div>
        <div class="offers">Breakfast Included, Free Wifi, Free Cancellation</div>
        <a href="" target="_blank" class="link">Book Now</a>
    </div>
<form id="booking-form">
  <label for="date-range">Select your stay:</label>
  <input id="date-range" name="date-range" required>
  <button type="submit">Book Now</button>
</form>

<script>
   flatpickr("#date-range", {
    mode: "range",
    minDate: "today",
    dateFormat: "Y-m-d"
  });

  document.getElementById('booking-form').addEventListener('submit', function(e) {
    e.preventDefault();
    const dates = document.getElementById('date-range').value;
    alert(`Selected dates: ${dates}`);
    // Call your booking function here
  });
 
        const slides = document.querySelectorAll('.carousel-slide');
        let currentIdx = 0;
        function showSlide(idx) {
            slides.forEach((sl, i) => sl.classList.toggle('active', i === idx));
        }
        document.querySelector('.carousel-btn.prev').onclick = function() {
            currentIdx = (currentIdx - 1 + slides.length) % slides.length;
            showSlide(currentIdx);
        };
        document.querySelector('.carousel-btn.next').onclick = function() {
            currentIdx = (currentIdx + 1) % slides.length;
            showSlide(currentIdx);
        };
          function renderProductDetails(product) {
              return  document.querySelector('.link');
          };
     // Fetch product details from query parameters
        const product = getQueryParams();
        const buyButton = renderProductDetails(product);

        const stripe = Stripe('pk_live_fgMxvyvoSrhEGCMCNixTpD7R'); // Replace with your Stripe publishable key

        async function createCheckoutSession(name, price, image) {
            const response = await fetch('/.netlify/functions/createCheckoutSession', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    name: name,
                    price: product.price*100, // Convert price to cents
                    image: image
                })
            });

            const session = await response.json();
            return session.id;
        }

        async function redirectToCheckout(sessionId) {
            const result = await stripe.redirectToCheckout({
                sessionId: sessionId
            });

            if (result.error) {
                console.error(result.error.message);
            }
        }
      // Function to get query parameters
        function getQueryParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                name: params.get('name'),
                price: params.get('price'),
                image_url: params.get('image_url')
            };
        }
let usPrice;
        // Event listener for Buy Now button
        buyButton.addEventListener('click', async () => {
          try{  let sessionId = await createCheckoutSession(product.name,  usPrice, product.image_url);
              const zparams = new URLSearchParams(window.location.search);
                               if (zparams.get('origin') == "usd") {
 sessionId = await createCheckoutSession(product.name,  product.price*100
                 , product.image_url);
                                //  usPrice=(((parseFloat(product.price.replace('$', ''))))+(((parseFloat(product.price.replace('$', ''))))*0.40))*0.0016;
                               } else if(zparams.get('origin') == "euro"){ 
                //   usPrice=     (((parseFloat(product.price.replace('₦', ''))*100))+(((parseFloat(product.price.replace('₦', ''))*100))*0.40))*0.0067;
                                    sessionId = await createCheckoutSession(product.name,  product.price*100
                 , product.image_url);
                         
}else {
                                    { 
            sessionId = await createCheckoutSession(product.name,   product.price*100
                 , product.image_url);                                                 
}
}
       
          
            await redirectToCheckout(sessionId);
             } catch (e) {
    alert('Checkout failed: ' + e.message);
    console.error(e);
  }
        });
    </script>
    <script src="https://js.stripe.com/v3/"></script>
</body>
</html>
